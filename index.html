<!DOCTYPE html>
<html lang="en" ng-app="mainApp">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="">
        <meta name="author" content="">

        <title>TinyTots</title>

        <!-- Bootstrap -->
        <link
        href="css/bootstrap.min.css" rel="stylesheet">

        <!-- Google Web Fonts -->
        <link
        href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,300i,400,400i,700,700i" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <!-- Template CSS Files  -->
        <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet">
        <link href="css/magnific-popup.css" rel="stylesheet">
        <link href="css/owl.carousel.css" rel="stylesheet">
        <link href="css/style.css" rel="stylesheet">
        <link href="css/responsive.css" rel="stylesheet">
        <link href="css/pagination.css" rel="stylesheet">
        <link
        rel="stylesheet" href="css/swiper-bundle.min.css">
        
        <!-- Angular Import -->
        <script src="./js/angular.min.js"></script>
        <script src="./js/angular-route.js"></script>
        <script src="./js/ngStorage.min.js"></script>

    </head>
    <body
        class="preloading" ng-app="mainApp">
        <!--Loading Starts-->
        <div class="load ">
            <img src="images/Loading/0.gif">
        </div>
        <!--Loading ends-->


        <!-- Header Section Starts -->
        <header class="header-area">
            <!-- Header Top Starts -->


            <!-- Header Top Ends -->
            <!-- Main Header Starts -->
                <div
                class="main-header"> <!-- Nested Container Starts -->
                <div
                    class="container px-md-0">
                    <!-- Nested Row Starts -->
                    <div
                        class="row">
                        <!-- Logo Starts -->
                        <div class="col-lg-2 col-md-4 col-sm-6 col-6 d-flex justify-content-center">
                            <div id="logo">
                                <a href="#/!"><img src="images/logo.png" title="" alt="" class="img-fluid img-center"></a>
                            </div>
                        </div>
                        <!-- Logo Ends -->
                        <!-- Search Starts -->
                        <div class="col-lg-8 col-md-4 col-sm-6 d-flex flex-fill align-items-center justify-content-evenly">
                            <nav
                                id="main-menu" class=" navbar navbar-expand-md rounded-0">
                                <!-- Nested Container Starts -->
                                <div
                                    class="container px-md-0">
                                    <!-- Navbar Toggler Starts -->
                                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target=".navbar-cat-collapse" aria-controls=".navbar-cat-collapse" aria-expanded="false" aria-badge="Toggle navigation">
                                        <span class="navbar-toggler-icon fa fa-bars"></span>
                                    </button>
                                    <!-- Navbar Toggler Ends -->
                                    <!-- Navbar Cat collapse Starts -->
                                    <div class="collapse navbar-collapse navbar-cat-collapse">
                                        <ul class="nav navbar-nav justify-content-between">
                                            <li class="nav-item">
                                                <a href="#/!" class="nav-link">Home</a>
                                            </li>
                                            <li class="nav-item">
                                                <a href="#!about" class="nav-link">About Us</a>
                                            </li>
                                            <li class="nav-item">
                                                <a href="#!category-grid" class="nav-link">
                                                    Products
                                                </a>
                                            </li>

                                            <li class="nav-item">
                                                <a href="#!news" class="nav-link">News</a>
                                            </li>
                                            <li class="nav-item">
                                                <a href="#!contact" class="nav-link">Contact us</a>
                                            </li>

                                        </ul>
                                    </div>
                                    <!-- Navbar Cat collapse Ends -->
                                </div>
                                <!-- Nested Container Ends -->
                            </nav>
                        </div>
                        <!-- Search Ends -->
                        <!-- Cart Starts -->
                        <div class="col-lg-2 col-md-4 col-sm-12 d-flex justify-content-center">
                            <a href="#!cart" id="cart" class="btn-group btn-block">
                                <button type="button" class="btn btn-block btn-lg dropdown-toggle text-uppercase text-md-right">
                                    <i class="fa fa-shopping-cart"></i>
                                    <strong class="d-none d-lg-inline-block">Shopping Cart</strong>

                                </button>

                            </a>
                        </div>
                        <!-- Cart Ends -->
                    </div>
                    <!-- Nested Row Ends -->
                </div>
                <!-- Nested Container Ends -->
            </div>
            <!-- Main Header Ends -->
        </header>
        <!-- Header Section Ends -->
        <!-- Main Menu Starts -->

        <!-- Main Menu Ends -->

        <!--View starts DO NOT TOUCH PLEASE--><div ng-view> </div>

        <!-- Footer Section Starts -->
        <footer
            id="footer-area">
            <!-- Footer Links Starts -->
            <div
                class="footer-links">
                <!-- Container Starts -->
                <div
                    class="container px-md-0">
                    <!-- Nested Row Starts -->
                    <div
                        class="row">
                        <!-- Foot Col#1 Starts -->
                        <div class="col-md-4 col-sm-12">
                            <h5>Subscription</h5>
                            <div class="foot-subscription-form">
                                <div class="input-group d-flex align-items-center justify-content-center">
                                    <input type="text" class="form-control text-uppercase" placeholder="Your Email Address">
                                    <span class="input-group-btn">
                                        <button class="btn text-uppercase" type="button">
                                            Subscribe
                                        </button>
                                    </span>
                                </div>
                            </div>
                            <h5>Stay Connected</h5>
                            <!-- Don't touch this -->
                            <ul class="list-unstyled list-inline foot-sm-links">
                                <li class="list-inline-item">
                                    <a href="#">
                                        <i class="fa fa-facebook"></i>
                                    </a>
                                </li>
                                <li class="list-inline-item">
                                    <a href="#">
                                        <i class="fa fa-twitter"></i>
                                    </a>
                                </li>
                                <li class="list-inline-item">
                                    <a href="#">
                                        <i class="fa fa-google-plus"></i>
                                    </a>
                                </li>
                                <li class="list-inline-item">
                                    <a href="#">
                                        <i class="fa fa-pinterest"></i>
                                    </a>
                                </li>
                                <li class="list-inline-item">
                                    <a href="#">
                                        <i class="fa fa-linkedin"></i>
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-4 col-sm-4"></div>
                        <!-- Foot Col#1 Ends -->
                        <!-- Customer Service Starts -->
                        <!-- <div class="col-md-2 col-sm-4 col-12">
                        							<h5>Customer Service</h5>
                        							<ul>
                        								<li><a href="#!contact">Contact Us</a></li>
                        								<li><a href="#">Returns</a></li>
                        								<li><a href="#">Site Map</a></li>
                        								<li><a href="#">Affiliates</a></li>
                        								<li><a href="#">Specials</a></li>
                        								<li><a href="#!faqs" >FAQs</a></li>
                        							</ul>
                        						</div> -->
                        <!-- Customer Service Ends -->
                        <!-- Contact Us Starts -->
                            <div class="col-md-4 col-sm-4 col-12 last"> <h5>Contact Us</h5>
                            <ul>

                                <li>TinyTots</li>
                                <li>
                                    590 Đ. Cách Mạng Tháng 8, Phường 11, Quận 3, Thành phố Hồ Chí Minh 723564
                                </li>
                                <li>
                                    Email:
                                    <a href="mailto:someone@example.com">info@demolink.com</a>
                                </li>
                                <li>
                                    Tel:
                                    <strong>1(234) 567-9842</strong>
                                </li>
                            </ul>
                        </div>
                        <!-- Contact Us Ends -->
                    </div>
                    <!-- Nested Row Ends -->
                </div>
                <!-- Container Ends -->
            </div>
            <!-- Footer Links Ends -->
            <!-- Copyright Area Starts -->
            <div
                class="copyright clearfix">
                <!-- Container Starts -->
                <div
                    class="container px-md-0 text-center text-md-left">
                    <!-- Starts -->
                    <p class="float-md-left">&copy; 2022 TinyTots Retail Corporated
                    </p>
                </a>
            </p>
            <!-- Ends -->
            <!-- Payment Gateway Links Starts -->
            <ul class="float-md-right list-inline">
                <li class="list-inline-item">
                    <img src="images/payment-icon/cirrus.png" alt="PaymentGateway"/>
                </li>
                <li class="list-inline-item">
                    <img src="images/payment-icon/paypal.png" alt="PaymentGateway"/>
                </li>
                <li class="list-inline-item">
                    <img src="images/payment-icon/visa.png" alt="PaymentGateway"/>
                </li>
                <li class="list-inline-item">
                    <img src="images/payment-icon/mastercard.png" alt="PaymentGateway"/>
                </li>
                <li class="list-inline-item">
                    <img src="images/payment-icon/americanexpress.png" alt="PaymentGateway"/>
                </li>
            </ul>
            <!-- Payment Gateway Links Ends -->
        </div>
        <!-- Container Ends -->
    </body>
</html></div><!-- Copyright Area Ends --></footer><!-- Footer Section Ends --><!-- Template JS Files --><script src="./js/jquery-3.3.1.min.js"></script><script src="./js/popper.min.js"></script><script src="./js/bootstrap.min.js"></script><script src="./js/jquery.magnific-popup.min.js"></script><script src="./js/owl.carousel.min.js"></script><script src="./js/custom.js"></script><script src="./js/swiper-bundle.min.js"></script><script src="./js/list.min.js"></script><script src="./js/app.js"></script><!--Loading js--><script></script><script src="./js/loading.js"></script>
<script>
$.getJSON("products.json", function (json) {
    var productArray = [];
    for (var key in json) {
        if (json.hasOwnProperty(key)) {
            var item = json[key];
            productArray.push({
                id: item.id,
                name: item.name,
                brand: item.brand,
                category: item.category,
                madeIn: item.madeIn,
                price: item.price,
                imgSrc: item.imgSrc,
                quantity: item.quantity
            });
        }
    }
});

var app = angular.module("mainApp", ["ngRoute", "ngStorage"]);

app.config(function ($routeProvider) {
    $routeProvider.when("/", {templateUrl: "main.html"}).when("/404", {templateUrl: "404.html"}).when("/about", {templateUrl: "about.html"}).when("/stores", {templateUrl: "stores.html"}).when("/news", {templateUrl: "news.html"}).when("/news-2", {templateUrl: "news-2.html"}).when("/news-3", {templateUrl: "news-3.html"}).when("/compare", {templateUrl: "compare.html"}).when("/franchise", {templateUrl: "franchise.html"}).when("/resources", {templateUrl: "resources.html"}).when("/category-grid", {
        templateUrl: "category-grid.html",
        controller: 'productsListController'
    }).when("/login", {templateUrl: "login.html"}).when("/register", {templateUrl: "register.html"}).when("/contact", {templateUrl: "contact.html"}).when("/cart", {templateUrl: "cart.html"}).when("/product-1/:id", {templateUrl: "product-full.html"});
});

app.controller("productsListController", function ($scope, $http, $localStorage, $sessionStorage, $routeParams) {
    const max = +10;
            const min = 0;
    
    $scope.$storage = $localStorage.$default({

    'products': []

    });
    $http.get("./js/products.json").then(function (response) {
        function getRandomProduct(){    
        return $scope.myData[Math.floor(Math.random() * $scope.myData.length)];
        };
        
        $scope.myData = response.data.products;
        $scope.products = {};
        $scope.categories = ['Baby Food','Formula','Body Care', 'Diapers', 'Softeners', 'Toys', 'Vitamins', 'Clothes'];
        $scope.filterProductsByCategory = function(category){
                $scope.search = category;
            };
        $scope.cloneItem = function(myData) {
            myData.quantity++;
            $scope.$storage.products.push({
                "id": myData.id,
                "name": myData.name,
                "brand": myData.brand,
                "category": myData.category,
                "madeIn": myData.madeIn,
                "price": myData.price,
                "imgSrc": myData.imgSrc,
                "quantity": myData.quantity  
            })
        }
        $scope.getLocalData = $localStorage.products;
      
        $scope.nuke = function() {
            for(i = 0; i < $localStorage.length; i++) {
                $localStorage.products.splice($localStorage.products.indexOf(i), 1);
            }
        }
        $scope.total = 0; 
  
        $scope.sumPrice = function(products) {
            var total = 0;
            angular.forEach(products,function(value,index){
            total += parseFloat(value.price);
            }); 
            return total.toFixed(2);
        };
        $scope.deleteItem = function(item) {
            $localStorage.products.splice($localStorage.products.indexOf(item), 1);
        }
        $scope.increment = function(item){
            if (item.quantity >= max) {
                return;
            }
            item.quantity++;
            $scope.$apply();
        }
        $scope.decrement = function(item){
            if (item.quantity <= min) {
                return;
            }
            item.quantity--;
            $scope.$apply();
        }
        $scope.reload = function() {
            $state.reload();
          };
        $scope.getCurrentQuantity = function (item) {
        var number = document.getElementById("currentQuantity");
        if (number > item.quantity) {
            increment(item);
        } else if (number < item.quantity) {
            decrement(item);
        } else {
            return;
        }
    }        
    });
});

app.controller("singleProductController", function ($scope, $http, $routeParams) {
	function getById(arr, paramId) {
                for (let i = 0; i < arr.length; i++) {
                    if (arr[i].id == paramId) {
                        return arr[i];
                    }
                }
            }
    $http.get("./js/products.json").then(function (response) {
        $scope.myData = response.data.products;
        $scope.products = getById($scope.myData, $routeParams.id);
    });
	
    $scope.txt='';
    
    $scope.resetText = function() {
        $scope.txt = '';
    };
});


// var singleProductController = angular.module('singleProductController', []);

//     singleProductController.controller('singleProductCtrl', [
// 	'$routeParams', '$scope', '$http', function ($routeParams, $scope, $http) {
// 		$http.get("./js/products.json").then(function (response) {
//         $scope.myData = response.data.products;
// 		function getById(arr, id) {
//                 for (var d = 0, len = arr.length; d < len; d += 1) {
//                     if (arr[d].id === id) {
//                         return arr[d];
//                     }
//                 }
//             }
//         $scope.products = getById($scope.products, $routeParams.id);
//     });

            // $scope.search = function () {
            //     var url = "./js/products.json";
            //     return $http.get(url).success(httpSuccess).error(function () {
            //         alert('Unable to get information from JSON ');
            //     });
            // }
            // httpSuccess = function (response) {
            //     $scope.products = response;
            // }

            // function getById(arr, id) {
            //     for (var d = 0, len = arr.length; d < len; d += 1) {
            //         if (arr[d].id === id) {
            //             return arr[d];
            //         }
            //     }
            // }
            // $scope.search();
            // $scope.products = getById($scope.products, $routeParams.id);
			// return products;
    //     }
    // ]);

</script> 
<script>
    
    function toast({title='' , message='',type='success' , duration=1000}){
            const main = document.getElementById('toast');
            if(main){
                const toast=document.createElement('div');
                //Auto remove toast
                const autoRemoveId= setTimeout(function(){
                    main.removeChild(toast);
                },duration + 1000)
                toast.onclick=function(e) {
                    if(e.target.closest('.toast__close')){
                        main.removeChild(toast);
                        clearTimeout(autoRemoveId);
                    }
                }
                const delay = (duration / 1000).toFixed(2);
                toast.classList.add('toast',`toast--${type}`);
                toast.style.animation = `slideInLeft ease 2s, fadeOut linear 3s ${delay}s forwards`;
                toast.innerHTML =`
                        <div class="toast__icon">
                        <i class="fa-solid fa-circle-check"></i>
                    </div>
                    <div class="toast__body">
                    <h3 class="toast__title">${title}</h3>
                    <p class="toast__msg">${message}</p>
                    </div>
                    <div class="toast__close">
                        <i class="fa-solid fa-xmark"></i>
                    </div>
                `;
                main.appendChild(toast);             
            }
          }
          
          function showSuccessToast(){
                toast({
                title:'Success',
                message:'Added to your cart',
                type:'success',
                duration : 1000
            })
          }

          function showSuccessCheckoutToast(){
                toast({
                title:'Successfully checked out',
                message:'Thank you for your purchase!',
                type:'success',
                duration : 1000
            })
          }
          
          function showSuccessReviewToast(){
                toast({
                title:'Review received',
                message:'Thank you for your thoughts!',
                type:'success',
                duration : 1500
            })
          }
</script>
</body></html>
